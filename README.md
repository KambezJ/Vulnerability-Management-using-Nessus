<h1>Vulnerability Management using Nessus</h1>


<h2>Description</h2>

In this lab you will learn the basics of vulnerability management and remediation using the Nessus Essentials Scanner on a VMWare virtual machine running on Windows 10. You will perform several scans of the VM; the first scan will run on the default system with no added credentials, the second will run with added credentials, and the third scan will run after installing a deprecated version of Mozilla Firefox. After the third scan, you will be tasked with remediating the most critical/high priority vulnerabilities. Finally, we will run a final scan to see how the overall health of the system has been impacted. Once the final results have been obtained, you will compare the differences in the Nessus logs with the scan that was run on the default system (second scan), and analyze the changes that have occured. Although the majority of vulnerabilities will be remediated, a small number will still remain, and you will be responsible for going through the "Remediations" tab, and conducting research to find solutions and ultimately get rid of all critical/high priority vulnerabilites.
<br />
Vulnerability management may not work exactly like this in a larger organization, but this lab will help you become familiarized with the core components of running scans for any given system. In a larger organization you may need to create/follow standardized procedures, coordinate with a team and all departements to obtain credentials for resources or create a plan of action (often, the human element is the most challenging due to the necessity of coordination), use a domain account to scan the entire system, use automation to perform some basic tasks like updates, and ensure that a secure build standard is being used before running scans. Regardless, this lab will provide safe sandbox environment in which you can practice the basics, and you can play around with various applications/softwares to earn vaulable experience in vulnerability management.


<h2>Tasks that will be performed:</h2>

- Vulnerability Detection, Assessment and Remediation
    <br />
- Implement Vulnerability Management Function on Sandbox Networks:
  - Discover, Prioritize, Assess, Report, Remediate, Verify
    <br />
- Install and configure Nessus Essentials to perform credentialed vulnerability scans and remediate them.</b>


<h2>Languages, Utilities and Environments Used</h2>

- Nessus Essentials
- VMWare Workstation Player
- Windows 10 ISO
- Command Prompt


<h2>Program Walk-through</h2>

<p align="center">
<b>Step 1: Download the VMware Workstation Player. </b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/9tnLj0WxmDPc/tQuK27g1W4GctefDYsDGmNbz5M2dVx0tAIpD1W1A.png" height="85%" width="85%" alt="Step 1"/>
</p>


<p align="center">
<b>Step 2: Download a Windows 10 ISO.</b> <br/>
<img src="https://i.imgur.com/rv5P1gY.png" height="85%" width="85%" alt="Step 2"/>
</p>


<p align="center">
<b>Step 3: Download Nessus Essentials by signing up on the website. You will receive an email with a download link, as well as a licence key that will be needed later in the lab.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/mbx8zp5SZqNY/3UH8CfhattOmhfnTRrkq3gnIbbRXJT7WiNUKnAxs.png" height="85%" width="85%" alt="Step 3"/>
</p>


<p align="center">
<b>Step 4: Continue with the Nessus Essentials set up by providing the licence key that was emailed to you and setting up a username/password.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/YpiU79iK7bmi/apX1IkLBHnywNNQQP03PapmdZzW8GzyGI4tLTeL4.png" height="85%" width="85%" alt="Step 4"/>
</p>


<p align="center">
<b>Step 5: Once VMware has finished downloading, create a new Virtual Machine (VM) and load the Windows 10 ISO onto it.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/hCWk4S1tcih3/HzITYumCCXhRoiP1nsRQ7hAfadi3w9Edtt73FhtF.png" height="85%" width="85%" alt="Step 5"/>
</p>


<p align="center">
<b>Step 6: Before selecting "finish" for the VM set up, go to "customize hardware", "network adapter", and under "network connection" select bridged. This basically puts the VM on the same network as our physical computer, allowing better connection/communication with Nessus.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/FzeX1TsnkuVF/O6aULkOlEISBUOFjSZglztU1xa51iBXZVtn2Qg9j.png" height="85%" width="85%" alt="Step 6"/>
</p>


<p align="center">
<b>Step 7: During the Windows 10 setup for the VM, select "I dont have a product key" when asekd for one, select Windows 10 pro, "custom install", "set up for personal use", "offline account", "limited experience", create username/password, and continue to finish.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/E470dG2EKCnI/pAIst2qEE3bDvaAS5P7lZ7pYhB35KESWmoFAZicQ.png" height="85%" width="85%" alt="Step 7"/>
</p>


<p align="center">
<b>Step 8: Now that the Windows 10 VM and Nessus essentials are downloaded, we will conduct a very basic scan of the VM as a test. In the VM, open Command Prompt and type ipconfig to check our IPv4 address.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/i7jgqu3hWdwd/qBPJZAaHi04JHfqiOigx2b8y0j0N0I4Fe5xJC29v.png" height="85%" width="85%" alt="Step 8"/>
</p>


<p align="center">
<b>Step 9: To ensure connectivity to our VM, we will go back to our physical computer (not the VM), open Command Prompt, and ping the VM's IP address. If a message appears saying "Request timed out.", you will need to go to the VM's firewall settings and disable Defender for the Domain, Private and Public Profile (only do this in a lab setting as it can be risky, unless you have other controls in place). Once you configure those settings, you will see that the error message has stopped and we are getting replies from the VM. This means that we have ensured connectivity to our VM now. To avoid a perpetual ping, you can press ctr-C to cancel the ping.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/lYvszDYy7EAx/lbgNrTthrFj3RHMYmWNIDSIprgQLC9LjEMFgKXp0.png" height="85%" width="85%" alt="Step 9"/>
</p>


<p align="center">
<b>Step 10: Now we can head back to the Nessus Essential page and we will create a new scan. Select "Basic Network Scan", name it, and enter the VM's IP address in the "targets" field. There are many other configurations and settings for creating a scan like adding credentials (for Nessus to scan the computer even more thorougly with admin privilages) or scheduling scans, but we will go over those later when we conduct a credentialed scan. Once you have saved this scan, select "launch now" to run the scan on the VM, and wait for it to completely finish.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/oe8AiCejgSrT/rjv6BW8k0hW3Ig49PB39BzwVvjkZd0SSKynwO0o7.png" height="85%" width="85%" alt="Step 10"/>
</p>


<p align="center">
<b>Step 11: Once the scan has finished running, we can go to the "Vulnerabilities" tab to view all of the potential vulnerabilities that Nessus has found for us.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/U1Pk2EgXZX4C/XmNzP9qQ69PVvFnHGkZmZKEV0mBm1Ah0Npr7DByE.png" height="85%" width="85%" alt="Step 11"/>
</p>


<p align="center">
<b>Step 12: We will click on the first log, which is a vulnerability listed as medium level severity. Once inside, you can see that there is a short description of what the vulnerability is, and below that they even suggest solutions and helpful links to help remediate it.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/5ImZQyeRV7qt/YxLdwCPav2nJIaEcfwhqks4bXez9HLnjysqf3Bib.png" height="85%" width="85%" alt="Step 12"/>
</p>


<p align="center">
<b>Step 13: Going down the list, you will see many logs with the label of "info". These are not necessarily vulnerabilities, but are helpful information that we should be aware of as a security analyst. We will now look at a log named "Target Credential Status by Authentication Protocol". What this is telling us that we did not provide administrative credentials so the scan was not able to run thoroughly into the system.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/fI0fHWsXsacR/dNLzJB7M2f0dEETtfbXgcnrsQ3kvkkpthWnbsfSv.png" height="85%" width="85%" alt="Step 13"/>
</p>


<p align="center">
<b>Step 14: Next, we will configure the VM settings to accept authenticated scans. By doing so, we will allow a more thorough scan of the VM to take place. On the VM, open services, and enable "Remote Registry". Select "automatic" for the startup type, then click on "start", and apply.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/D9iPrFGZt5LY/nlm0ZkGjObkkqMZ3hAY5fbHDkcmWD2iB9Hdl8C36.png" height="85%" width="85%" alt="Step 14"/>
</p>


<p align="center">
<b>Step 15: Now that Remote Registry is enabled and turned on, we will need to enable File and Printer Sharing. In the VM's search bar, search for and open "Share across devices", then turn on the following settings to match.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/SbJ21AVq06EF/Rd2wJeANsEGfrFCikK1IcwVhcycuNExoaejGaDrC.png" height="85%" width="85%" alt="Step 15"/>
</p>


<p align="center">
<b>Step 16: Once again, go to the windows search bar on the VM, but this time we will search for "User Account Control Settings", open it, and slide the bar all the way down to turn off the notifications. This is not something you would typically do in an organization, but this VM is not on a shared domain so we will have to configure the settings to ensure our scanner functions correctly during this lab.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/tMsZ0lmQYvA0/pG03d2CPwDhGDK6JdPYuogeduJ9ry0ByB0iAhqVZ.png" height="85%" width="85%" alt="Step 16"/>
</p>


<p align="center">
<b> Step 17: Next, search for "Registry Editor" on the VM and open it. We will add a key that will add a key that will allow the remote account to connect to the VM and further disable user account control for the remote account used to connect to the VM during the scan. browse to "HKEY_LOCAL_MACHINE", "SOFTWARE", "Microsoft", "Windows", "Current Version", "Policies", and "System". Inside this, we will right click to create a DWORD called "local account token filter policy" and set the value to 1. Restart the VM and sign back in, and now the VM is ready to be scanned.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/VtUYPXAmUUcF/8vyzowY9VTEiU1iXVNx5PMHixWe2YSQ1N4W5qgEb.png" height="85%" width="85%" alt="Step 17"/>
</p>


<p align="center">
<b>Step 18: Go back to the Nessus Essentials page, right click the scan we created to configure it (or you can create a new scan). Go to "Credentials", under categories select "windows", select "password" for authentication method, and enter the username and password you use to log into Windows on the VM. (TIP: If you have forgotten your username, you can open Command Prompt and enter the whoami command). Run the scan and wait for it to finish, and next we will compare the results of this scan with the initial/basic scan that we ran previously.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/yuUN3wdwkE2Y/VOxdGHEEspUdrnrZecYfXLVEa8Gi8zTzrAQpvqXl.png" height="85%" width="85%" alt="Step 18"/>
</p>


<p align="center">
<b>Step 19a: You will immediately notice the difference with the credentialed scan. During the initial scan we only had 1 medium level vulnerability, but now we have many critical, high and medium level vulnerabilities. Take a few minutes to go through the vulnerability logs to see what they are and what Tenable/Nessus reccomends to remediate them. </b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/AXeTFQX2zaEU/nUOaLZpFX1yBpjXAeLy0YCMxibFz0v98Bd3dHrTu.png" height="85%" width="85%" alt="Step 19"/>
</p>


<p align="center">
<b>Step 19b: You can also go to the "Remediatioins" tab and Nessus/Tenable will give you a high level breakdown of what can be done to remediate some of the critical vulnerabilities. </b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/rfimABycV8if/ooBBUlJWJLgvDEwKO0Jp0ZF16Ob5nRK6QYb7vv8G.png" height="85%" width="85%" alt="Step 19"/>
</p>


<p align="center">
<b>Step 19c: On the "VPR Top Threats" tab, Tenable/Nessus gives us a list of threats that we should prioritize based on their metrics. Many of these threats/vulnerabilities are quite simple and can be fixed (in an organization) using automated patching tools, but this nonetheless gives us a fundamental idea of how to use the scanner and what we should look for.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/uY1q6gq4wGcA/CVBNgjwgsv9vim0q9F2uc697OSkQwtiRdYWeo829.png" height="85%" width="85%" alt="Step 19"/>
</p>


<p align="center">
<b>Step 20: Now, we will download an old, deprecated software onto our VM (in this case, an old version of Firefox) and we will run another scan to analyze the results. Navigate to the provided link and download the old version of Firefox on the VM. *WARNING: Make sure that you do not download this onto your actual, physical computer*. </b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/vNGiduDLAzJg/rQxXJ6EpiRBTg3DI5EjHLJox0754i9UD7Z2XLtEm.png" height="85%" width="85%" alt="Step 20"/>
</p>


<p align="center">
<b>Step 21: After the software has been downloaded, run the scan again and wait for the results. You will notice that the amount of vulnerabilites has dramatically increased with the introduction of the deprecated software on our VM. By going to the "history" tab, you can see how the results have changed with each scan.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/1mnxByinXMK1/DZVecRuGnqmyLbcefuKZIY7KDV38S3r3duGAvM6D.png" height="85%" width="85%" alt="Step 21"/>
</p>


<p align="center">
<b>Step 22: Now we will try to remove all of the critical vulnerabilites. Most of these can be remediated by simply updating Windows, Edge and Firefox until the vulnerabilities are no longer present. In an organization, most of these tasks can be completed through automation, but for this lab we will complete them manually so you can have a better understanding of how Nessus/vulnerabily management works. On the VM, run/open "appwiz.cpl" and uninstall Mozilla Firefox.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/DwnJIUfMgUfw/P8hPkK5E8aDH3u2TT7viY5WUu2HBCU6syRgCM2sh.png" height="85%" width="85%" alt="Step 22"/>
</p>


<p align="center">
<b>Step 23: Next, search for "Windows Update", open it, and click on "check for updates". Restart the computer after the updates have been downloaded, and continue updating and restarting until all updates have been installed. </b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/Hyv2j4nklszK/cqXkqzVgSDzpuIqw3Onh6iNTWwxfsFaBpFWaOxne.png" height="85%" width="85%" alt="Step 23"/>
</p>


<p align="center">
<b>Step 24: Once there are no more updates available for Windows, go back to the Nesses Dashboard and run the same scan again. You will notice that the number of critical/high vulnerabilites has drastically decreased since the last scan. </b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/HFRytuagv5bV/SCIQipmo0DDIWlQcEOz4D5pnhsdTSqglsiON9r82.png" height="85%" width="85%" alt="Step 24"/>
</p>


<p align="center">
<b>Step 25: Take a few minutes to go through the remaining vulnerabilites. You will notice that almost all of the critical/high level vulnerabilities are coming from Microsoft Edge, and this can easily be remediated through updates or configuration of settings.</b> <br/>
<img src="https://pixelfed.de/storage/m/_v2/676491643439523429/c6a394f69-21cf85/CPFQ43YQfoTz/aaV7m1Xb0RWijNBdi0La4JotOHeFQZqtW52SSwaX.png" height="85%" width="85%" alt="Step 25"/>
</p>
